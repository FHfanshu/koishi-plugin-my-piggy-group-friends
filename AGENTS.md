# Repository Guidelines

## Project Structure & Module Organization
- `src/` holds the TypeScript source for the Koishi plugin (commands, services, config, constants).
- `lib/` is the compiled output (generated by the build script).
- `pig_svgs/` contains the SVG assets used for card rendering.
- `README.md` documents user-facing features and config options.

Key modules:
- `src/index.ts` wires commands, middleware, and cron jobs.
- `src/services/` contains rendering, location generation, and API integrations.
- `src/config.ts` defines Koishi config schema and defaults.

## Build, Test, and Development Commands
- `npm run build` â€” runs `yakumo build` to compile `src/` into `lib/`.

There are no repository-local test scripts defined in `package.json`.

## Coding Style & Naming Conventions
- Language: TypeScript. Follow existing patterns in `src/`.
- Indentation: 2 spaces; keep line length readable.
- Naming: camelCase for variables/functions, PascalCase for types/interfaces, and kebab-case for commands (e.g., `pig.map`).
- Prefer async/await and explicit error handling with `ctx.logger` for operational visibility.

## Testing Guidelines
- No automated test framework is configured in this repo.
- If you add tests, document the framework and add a script to `package.json`.

## Commit & Pull Request Guidelines
- Recent history follows Conventional Commit-style prefixes (`feat:`, `fix:`, `chore:`), sometimes with bilingual summaries.
- Keep commits focused and describe user-visible behavior changes.
- PRs should include:
  - a concise description,
  - configuration changes (if any), and
  - screenshots for UI/card output changes when applicable.

## Configuration & Ops Notes
- The plugin expects Koishi services like `database`, `cron`, and `puppeteer`.
- Optional integrations include `chatluna`, `chatluna_storage`, and `media-luna`.
- When touching image/LLM flows, verify fallbacks and log messages for failure cases.
